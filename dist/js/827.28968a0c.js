"use strict";(self["webpackChunkleftyprint"]=self["webpackChunkleftyprint"]||[]).push([[827],{4751:function(e,t,s){function a(e){return{all:e=e||new Map,on:function(t,s){var a=e.get(t);a?a.push(s):e.set(t,[s])},off:function(t,s){var a=e.get(t);a&&(s?a.splice(a.indexOf(s)>>>0,1):e.set(t,[]))},emit:function(t,s){var a=e.get(t);a&&a.slice().map((function(e){e(s)})),(a=e.get("*"))&&a.slice().map((function(e){e(t,s)}))}}}s.d(t,{Z:function(){return i}});const l=a();var i=l},9802:function(e,t,s){s.d(t,{Z:function(){return d}});var a=s(6252);function l(e,t,s,l,i,r){return(0,a.wg)(),(0,a.iD)("div")}var i=s(4751),r={data(){return{data:{position:"top",toast:!0,icon:"success",title:"",showConfirmButton:!1,timer:1500}}},methods:{showAlert(e){this.$swal(e)}},mounted(){i.Z.on("sweetalert",(e=>{const t=e.split(", ");this.data.title=t[0],this.data.icon=t[1],this.$swal.fire(this.data)}))},unmounted(){i.Z.off("sweetalert")}},n=s(3744);const o=(0,n.Z)(r,[["render",l]]);var d=o},2827:function(e,t,s){s.r(t),s.d(t,{default:function(){return ne}});var a=s(6252),l=s(3577),i=s(9963);const r={class:"container mt-5"},n=(0,a._)("h1",{class:"fs-3 text-dark text-center"},[(0,a._)("span",{class:"align-middle"},"購物車")],-1),o={class:"row"},d={class:"col-8"},c={class:"mb-3 border"},m={class:"px-4 py-2 bg-gray-100 fw-bold d-flex justify-content-between border-bottom"},u=(0,a._)("span",{class:"text-primary"},"項目",-1),f=["disabled"],h={key:0,class:"p-4 text-secondary"},p={key:1},g={key:0,style:{height:"100px"}},v={key:1},_=["src"],b=(0,a.Uk)("  "),w=["src"],y={class:"fw-bold mb-2"},$=(0,a._)("br",null,null,-1),k={class:"text-secondary fs-7"},x=(0,a._)("br",null,null,-1),C=["onClick"],V=(0,a._)("span",{class:"material-symbols-outlined align-middle"},"delete",-1),Z=[V],L={class:"border"},U=(0,a._)("div",{class:"px-4 py-2 text-primary fw-bold bg-gray-100"}," 收件人 ",-1),W={class:"py-4 row justify-content-center"},z={class:"col-6"},P={class:"mb-2"},A=(0,a._)("label",{for:"name",class:"form-label fs-7"},"姓名",-1),D={class:"mb-2"},E=(0,a._)("label",{for:"email",class:"form-label fs-7"},"Email",-1),j={class:"mb-2"},q=(0,a._)("label",{for:"tel",class:"form-label fs-7"},"電話",-1),S={class:"mb-2"},M=(0,a._)("label",{for:"address",class:"form-label fs-7"},"地址",-1),H={class:"mb-2"},Y=(0,a._)("label",{for:"message",class:"form-label fs-7"},"訂單備註",-1),B={class:"col"},F={class:"border bg-gray-100 sticky-top"},K=(0,a._)("div",{class:"p-2 text-center bg-gray-200"}," 訂單摘要 ",-1),O={class:"p-3"},X={class:"d-flex justify-content-between"},G=(0,a._)("div",null,"商品總計",-1),I=(0,a._)("div",{class:"d-flex justify-content-between"},[(0,a._)("div",null,"運費總計"),(0,a._)("div",null,"免運費")],-1),J={class:"p-3 d-flex justify-content-between"},N=(0,a._)("div",null,"結帳總金額",-1),Q={class:"fw-bolder text-danger"},R=(0,a.Uk)("$ "),T={class:"fs-5"},ee=(0,a._)("div",{class:"d-grid p-3"},[(0,a._)("button",{type:"submit",class:"btn btn-primary"},"結帳")],-1);function te(e,t,s,V,te,se){const ae=(0,a.up)("v-loading"),le=(0,a.up)("SweetAlert"),ie=(0,a.up)("v-field"),re=(0,a.up)("error-message"),ne=(0,a.up)("v-form");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(ae,{active:te.isLoading},null,8,["active"]),(0,a.Wm)(le),(0,a._)("div",r,[n,(0,a.Wm)(ne,{ref:"form",onSubmit:se.onSubmit},{default:(0,a.w5)((({errors:e})=>[(0,a._)("div",o,[(0,a._)("div",d,[(0,a._)("div",c,[(0,a._)("div",m,[u,(0,a._)("button",{class:"btn btn-sm btn-outline-secondary",onClick:t[0]||(t[0]=e=>se.clearCarts()),disabled:te.carts.length<=0},"清除購物車",8,f)]),(0,a._)("div",null,[te.carts.length<=0?((0,a.wg)(),(0,a.iD)("p",h,"購物車尚無內容")):((0,a.wg)(),(0,a.iD)("div",p,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(te.carts,(e=>((0,a.wg)(),(0,a.iD)("div",{key:e.id,class:"p-4 d-flex justify-content-between align-items-center"},[(0,a._)("div",null,[void 0===e.files?((0,a.wg)(),(0,a.iD)("div",g,"   ")):((0,a.wg)(),(0,a.iD)("div",v,[(0,a._)("img",{src:e.files[0].front,class:"border",height:"100",alt:""},null,8,_),b,(0,a._)("img",{src:e.files[0].back,class:"border",height:"100",alt:""},null,8,w)]))]),(0,a._)("div",null,[(0,a._)("span",y,(0,l.zw)(e.product.title),1),$,(0,a._)("span",k,[(0,a.Uk)((0,l.zw)(e.product.width)+" mm X "+(0,l.zw)(e.product.height)+" mm ",1),x,(0,a.Uk)(" "+(0,l.zw)(e.product.side)+" ／ "+(0,l.zw)(e.product.material)+" ／ "+(0,l.zw)(e.product.p_qty)+" "+(0,l.zw)(e.product.unit),1)])]),(0,a._)("div",null,"$ "+(0,l.zw)(e.product.price),1),(0,a._)("div",null,[(0,a._)("a",{href:"#",class:"btn btn-sm btn-link",onClick:(0,i.iM)((t=>se.delCart(e,e.files[0].id)),["prevent"])},Z,8,C)])])))),128))]))])]),(0,a._)("div",L,[U,(0,a._)("div",W,[(0,a._)("div",z,[(0,a._)("div",P,[A,(0,a.Wm)(ie,{name:"姓名",id:"name",type:"text",rules:"required",class:(0,l.C_)(["form-control",{"is-invalid":e["姓名"]}]),modelValue:te.order.user.name,"onUpdate:modelValue":t[1]||(t[1]=e=>te.order.user.name=e),placeholder:"填入姓名"},null,8,["class","modelValue"]),(0,a.Wm)(re,{name:"姓名",class:"invalid-feedback"})]),(0,a._)("div",D,[E,(0,a.Wm)(ie,{name:"email",id:"email",type:"email",rules:"required|email",class:(0,l.C_)(["form-control",{"is-invalid":e["email"]}]),modelValue:te.order.user.email,"onUpdate:modelValue":t[2]||(t[2]=e=>te.order.user.email=e),placeholder:"填入 Email"},null,8,["class","modelValue"]),(0,a.Wm)(re,{name:"email",class:"invalid-feedback"})]),(0,a._)("div",j,[q,(0,a.Wm)(ie,{name:"電話",id:"tel",type:"tel",rules:"required|numeric|min:7|max:10",class:(0,l.C_)(["form-control",{"is-invalid":e["電話"]}]),modelValue:te.order.user.tel,"onUpdate:modelValue":t[3]||(t[3]=e=>te.order.user.tel=e)},null,8,["class","modelValue"]),(0,a.Wm)(re,{name:"電話",class:"invalid-feedback"})]),(0,a._)("div",S,[M,(0,a.Wm)(ie,{name:"地址",id:"address",type:"text",rules:"required",class:(0,l.C_)(["form-control",{"is-invalid":e["地址"]}]),modelValue:te.order.user.address,"onUpdate:modelValue":t[4]||(t[4]=e=>te.order.user.address=e)},null,8,["class","modelValue"]),(0,a.Wm)(re,{name:"地址",class:"invalid-feedback"})]),(0,a._)("div",H,[Y,(0,a.Wm)(ie,{as:"textarea",name:"message",id:"message",class:"form-control",rows:"3",modelValue:te.order.message,"onUpdate:modelValue":t[5]||(t[5]=e=>te.order.message=e)},null,8,["modelValue"])])])])])]),(0,a._)("div",B,[(0,a._)("div",F,[K,(0,a._)("div",O,[(0,a._)("div",X,[G,(0,a._)("div",null,"$ "+(0,l.zw)(te.total),1)]),I]),(0,a._)("div",J,[N,(0,a._)("div",Q,[R,(0,a._)("span",T,(0,l.zw)(Math.round(te.final_total)),1)])]),ee])])])])),_:1},8,["onSubmit"])])],64)}var se=s(4751),ae=s(9802),le={data(){return{VUE_APP:"https://vue3-course-api.hexschool.io/v2/api/groen",isLoading:!1,total:0,final_total:0,carts:[],order:{user:{name:"",email:"",tel:"",address:""},message:""}}},components:{SweetAlert:ae.Z},methods:{getCarts(){this.isLoading=!0;const e=`${this.VUE_APP}/cart`;this.$http.get(e).then((e=>{console.log(e.data.data),this.isLoading=!1,this.total=e.data.data.total,this.final_total=e.data.data.final_total;const t=e.data.data.carts,s=[];t.forEach((e=>{if(void 0===e.files||e.files.length<=1)s.push(e);else{const t=e.files.length;for(let a=0;a<t;a++){const t={...e};t.files=[e.files[a]],t.files[0].id=a+1,s.push(t)}}})),this.carts=s,se.Z.emit("cartCount")})).catch((e=>{this.isLoading=!1,se.Z.emit("sweetalert",`${e.response.data.message}, error`)}))},clearCarts(){this.isLoading=!0;const e=`${this.VUE_APP}/carts`;this.$http.delete(e).then((e=>{this.isLoading=!1,se.Z.emit("sweetalert",`${e.data.message}, success`),this.getCarts()})).catch((e=>{this.isLoading=!1,se.Z.emit("sweetalert",`${e.response.data.message}, error`)}))},delCart(e,t){this.isLoading=!0;const s=`${this.VUE_APP}/cart`;this.$http.get(s).then((s=>{const a=s.data.data.carts,l=a.find((t=>t.product_id===e.product_id));if(void 0===l.files||l.files.length<=1){const t=`https://vue3-course-api.hexschool.io/v2/api/groen/cart/${e.id}`;this.$http.delete(t).then((e=>{this.isLoading=!1,se.Z.emit("sweetalert",`${e.data.message}, success`),this.getCarts()})).catch((e=>{this.isLoading=!1,se.Z.emit("sweetalert",`${e.response.data.message}, error`)}))}else{l.files.splice(t-1,1);const s=`https://vue3-course-api.hexschool.io/v2/api/groen/cart/${e.id}`;this.$http.put(s,{data:{product_id:l.id,qty:1,files:l.files}}).then((e=>{this.isLoading=!1,se.Z.emit("sweetalert",`${e.data.message}, success`),this.getCarts()})).catch((e=>{this.isLoading=!1,se.Z.emit("sweetalert",`${e.response.data.message}, error`)}))}})).catch((e=>{this.isLoading=!1,se.Z.emit("sweetalert",`${e.response.data.message}, error`)}))},onSubmit(){this.isLoading=!0;const e=`${this.VUE_APP}/order`;this.$http.post(e,{data:{...this.order}}).then((e=>{this.isLoading=!1,se.Z.emit("sweetalert",`${e.data.message}, success`),this.getCarts(),this.$refs.form.resetForm()})).catch((e=>{this.isLoading=!1,se.Z.emit("sweetalert",`${e.response.data.message}, error`)}))}},mounted(){this.getCarts()}},ie=s(3744);const re=(0,ie.Z)(le,[["render",te]]);var ne=re}}]);
//# sourceMappingURL=827.28968a0c.js.map