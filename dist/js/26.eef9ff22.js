"use strict";(self["webpackChunkleftyprint"]=self["webpackChunkleftyprint"]||[]).push([[26],{4751:function(e,s,t){function a(e){return{all:e=e||new Map,on:function(s,t){var a=e.get(s);a?a.push(t):e.set(s,[t])},off:function(s,t){var a=e.get(s);a&&(t?a.splice(a.indexOf(t)>>>0,1):e.set(s,[]))},emit:function(s,t){var a=e.get(s);a&&a.slice().map((function(e){e(t)})),(a=e.get("*"))&&a.slice().map((function(e){e(s,t)}))}}}t.d(s,{Z:function(){return i}});const l=a();var i=l},9802:function(e,s,t){t.d(s,{Z:function(){return d}});var a=t(6252);function l(e,s,t,l,i,r){return(0,a.wg)(),(0,a.iD)("div")}var i=t(4751),r={data(){return{data:{position:"top",toast:!0,icon:"success",title:"",showConfirmButton:!1,timer:1500}}},methods:{showAlert(e){this.$swal(e)}},mounted(){i.Z.on("sweetalert",(e=>{const s=e.split(", ");this.data.title=s[0],this.data.icon=s[1],this.$swal.fire(this.data)}))},unmounted(){i.Z.off("sweetalert")}},o=t(3744);const n=(0,o.Z)(r,[["render",l]]);var d=n},2026:function(e,s,t){t.r(s),t.d(s,{default:function(){return me}});var a=t(6252),l=t(3577),i=t(9963),r=t(5689);const o={class:"container mt-5"},n=(0,a._)("h1",{class:"fs-3 text-dark"},[(0,a._)("img",{src:r,class:"me-3",height:"55",alt:""}),(0,a._)("span",{class:"align-middle"},"購物車")],-1),d={class:"row g-4"},c={class:"col-lg-8 col-12"},m={class:"mb-3 border"},u={class:"px-4 py-2 bg-gray-100 fw-bold d-flex justify-content-between border-bottom"},f=(0,a._)("span",null,"項目",-1),h=["disabled"],p={key:0,class:"p-4 text-secondary"},g={key:1},v={class:"d-xl-flex"},_={class:"mb-xl-0 mb-4 me-3"},b={key:0,style:{height:"100px"}},w={key:1},y=["src"],$=(0,a.Uk)("  "),x=["src"],k={class:"fw-bold mb-2"},C=(0,a._)("br",null,null,-1),V={class:"text-secondary fs-7"},Z=(0,a._)("br",null,null,-1),L={class:"text-nowrap"},U=["onClick"],W=(0,a._)("span",{class:"material-symbols-outlined align-middle"},"delete",-1),z=[W],P={class:"border"},A=(0,a._)("div",{class:"px-4 py-2 fw-bold bg-gray-100"}," 收件人 ",-1),D={class:"py-4 row justify-content-center"},E={class:"col-xl-6 col-sm-8 col-10"},j={class:"mb-2"},q=(0,a._)("label",{for:"name",class:"form-label fs-7"},"姓名",-1),S={class:"mb-2"},M=(0,a._)("label",{for:"email",class:"form-label fs-7"},"Email",-1),H={class:"mb-2"},Y=(0,a._)("label",{for:"tel",class:"form-label fs-7"},"電話",-1),B={class:"mb-2"},F=(0,a._)("label",{for:"address",class:"form-label fs-7"},"地址",-1),K={class:"mb-4"},O=(0,a._)("label",{for:"message",class:"form-label fs-7"},"訂單備註",-1),X=(0,a._)("div",{class:"d-grid"},[(0,a._)("button",{type:"submit",class:"btn btn-primary"},"結帳")],-1),G={class:"col-lg col-12"},I={class:"border bg-gray-100 sticky-top"},J=(0,a._)("div",{class:"p-2 text-center bg-gray-200"}," 訂單摘要 ",-1),N={class:"p-3"},Q={class:"d-flex justify-content-between"},R=(0,a._)("div",null,"商品總計",-1),T=(0,a._)("div",{class:"d-flex justify-content-between"},[(0,a._)("div",null,"運費總計"),(0,a._)("div",null,"免運費")],-1),ee={class:"p-3 d-flex justify-content-between"},se=(0,a._)("div",null,"結帳總金額",-1),te={class:"fw-bolder text-danger"},ae=(0,a.Uk)("$ "),le={class:"fs-5"};function ie(e,s,t,r,W,ie){const re=(0,a.up)("v-loading"),oe=(0,a.up)("SweetAlert"),ne=(0,a.up)("v-field"),de=(0,a.up)("error-message"),ce=(0,a.up)("v-form");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(re,{active:W.isLoading},null,8,["active"]),(0,a.Wm)(oe),(0,a._)("div",o,[n,(0,a._)("div",d,[(0,a._)("div",c,[(0,a._)("div",m,[(0,a._)("div",u,[f,(0,a._)("button",{class:"btn btn-sm btn-outline-secondary",onClick:s[0]||(s[0]=e=>ie.clearCarts()),disabled:W.carts.length<=0},"清除購物車",8,h)]),(0,a._)("div",null,[W.carts.length<=0?((0,a.wg)(),(0,a.iD)("p",p,"購物車尚無內容")):((0,a.wg)(),(0,a.iD)("div",g,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(W.carts,(e=>((0,a.wg)(),(0,a.iD)("div",{key:e.id,class:"p-4 d-flex justify-content-between align-items-center"},[(0,a._)("div",v,[(0,a._)("div",_,[void 0===e.files?((0,a.wg)(),(0,a.iD)("div",b,"   ")):((0,a.wg)(),(0,a.iD)("div",w,[(0,a._)("img",{src:e.files[0].front,class:"border",height:"100",alt:""},null,8,y),$,(0,a._)("img",{src:e.files[0].back,class:"border",height:"100",alt:""},null,8,x)]))]),(0,a._)("div",null,[(0,a._)("span",k,(0,l.zw)(e.product.title),1),C,(0,a._)("span",V,[(0,a.Uk)((0,l.zw)(e.product.width)+" mm X "+(0,l.zw)(e.product.height)+" mm ",1),Z,(0,a.Uk)(" "+(0,l.zw)(e.product.side)+" ／ "+(0,l.zw)(e.product.material)+" ／ "+(0,l.zw)(e.product.p_qty)+" "+(0,l.zw)(e.product.unit),1)])])]),(0,a._)("div",L,"$ "+(0,l.zw)(e.product.price),1),(0,a._)("div",null,[(0,a._)("a",{href:"#",class:"btn btn-sm btn-link",onClick:(0,i.iM)((s=>ie.delCart(e,e.files[0].id)),["prevent"])},z,8,U)])])))),128))]))])]),(0,a._)("div",P,[A,(0,a._)("div",D,[(0,a._)("div",E,[(0,a.Wm)(ce,{class:"py-4",ref:"form",onSubmit:ie.onSubmit},{default:(0,a.w5)((({errors:e})=>[(0,a._)("div",j,[q,(0,a.Wm)(ne,{name:"姓名",id:"name",type:"text",rules:"required",class:(0,l.C_)(["form-control",{"is-invalid":e["姓名"]}]),modelValue:W.order.user.name,"onUpdate:modelValue":s[1]||(s[1]=e=>W.order.user.name=e),placeholder:"填入姓名"},null,8,["class","modelValue"]),(0,a.Wm)(de,{name:"姓名",class:"invalid-feedback"})]),(0,a._)("div",S,[M,(0,a.Wm)(ne,{name:"email",id:"email",type:"email",rules:"required|email",class:(0,l.C_)(["form-control",{"is-invalid":e["email"]}]),modelValue:W.order.user.email,"onUpdate:modelValue":s[2]||(s[2]=e=>W.order.user.email=e),placeholder:"填入 Email"},null,8,["class","modelValue"]),(0,a.Wm)(de,{name:"email",class:"invalid-feedback"})]),(0,a._)("div",H,[Y,(0,a.Wm)(ne,{name:"電話",id:"tel",type:"tel",rules:"required|numeric|min:7|max:10",class:(0,l.C_)(["form-control",{"is-invalid":e["電話"]}]),modelValue:W.order.user.tel,"onUpdate:modelValue":s[3]||(s[3]=e=>W.order.user.tel=e)},null,8,["class","modelValue"]),(0,a.Wm)(de,{name:"電話",class:"invalid-feedback"})]),(0,a._)("div",B,[F,(0,a.Wm)(ne,{name:"地址",id:"address",type:"text",rules:"required",class:(0,l.C_)(["form-control",{"is-invalid":e["地址"]}]),modelValue:W.order.user.address,"onUpdate:modelValue":s[4]||(s[4]=e=>W.order.user.address=e)},null,8,["class","modelValue"]),(0,a.Wm)(de,{name:"地址",class:"invalid-feedback"})]),(0,a._)("div",K,[O,(0,a.Wm)(ne,{as:"textarea",name:"message",id:"message",class:"form-control",rows:"3",modelValue:W.order.message,"onUpdate:modelValue":s[5]||(s[5]=e=>W.order.message=e)},null,8,["modelValue"])]),X])),_:1},8,["onSubmit"])])])])]),(0,a._)("div",G,[(0,a._)("div",I,[J,(0,a._)("div",N,[(0,a._)("div",Q,[R,(0,a._)("div",null,"$ "+(0,l.zw)(W.total),1)]),T]),(0,a._)("div",ee,[se,(0,a._)("div",te,[ae,(0,a._)("span",le,(0,l.zw)(Math.round(W.final_total)),1)])])])])])])],64)}var re=t(4751),oe=t(9802),ne={data(){return{VUE_APP:"https://vue3-course-api.hexschool.io/v2/api/groen",isLoading:!1,total:0,final_total:0,carts:[],order:{user:{name:"",email:"",tel:"",address:""},message:""}}},components:{SweetAlert:oe.Z},methods:{getCarts(){this.isLoading=!0;const e=`${this.VUE_APP}/cart`;this.$http.get(e).then((e=>{console.log(e.data.data),this.isLoading=!1,this.total=e.data.data.total,this.final_total=e.data.data.final_total;const s=e.data.data.carts,t=[];s.forEach((e=>{if(void 0===e.files||e.files.length<=1)t.push(e);else{const s=e.files.length;for(let a=0;a<s;a++){const s={...e};s.files=[e.files[a]],s.files[0].id=a+1,t.push(s)}}})),this.carts=t,re.Z.emit("cartCount")})).catch((e=>{this.isLoading=!1,re.Z.emit("sweetalert",`${e.response.data.message}, error`)}))},clearCarts(){this.isLoading=!0;const e=`${this.VUE_APP}/carts`;this.$http.delete(e).then((e=>{this.isLoading=!1,re.Z.emit("sweetalert",`${e.data.message}, success`),this.getCarts()})).catch((e=>{this.isLoading=!1,re.Z.emit("sweetalert",`${e.response.data.message}, error`)}))},delCart(e,s){this.isLoading=!0;const t=`${this.VUE_APP}/cart`;this.$http.get(t).then((t=>{const a=t.data.data.carts,l=a.find((s=>s.product_id===e.product_id));if(void 0===l.files||l.files.length<=1){const s=`https://vue3-course-api.hexschool.io/v2/api/groen/cart/${e.id}`;this.$http.delete(s).then((e=>{this.isLoading=!1,re.Z.emit("sweetalert",`${e.data.message}, success`),this.getCarts()})).catch((e=>{this.isLoading=!1,re.Z.emit("sweetalert",`${e.response.data.message}, error`)}))}else{l.files.splice(s-1,1);const t=`https://vue3-course-api.hexschool.io/v2/api/groen/cart/${e.id}`;this.$http.put(t,{data:{product_id:l.id,qty:1,files:l.files}}).then((e=>{this.isLoading=!1,re.Z.emit("sweetalert",`${e.data.message}, success`),this.getCarts()})).catch((e=>{this.isLoading=!1,re.Z.emit("sweetalert",`${e.response.data.message}, error`)}))}})).catch((e=>{this.isLoading=!1,re.Z.emit("sweetalert",`${e.response.data.message}, error`)}))},onSubmit(){this.isLoading=!0;const e=`${this.VUE_APP}/order`;this.$http.post(e,{data:{...this.order}}).then((e=>{this.isLoading=!1,re.Z.emit("sweetalert",`${e.data.message}, success`),this.getCarts(),this.$refs.form.resetForm()})).catch((e=>{this.isLoading=!1,re.Z.emit("sweetalert",`${e.response.data.message}, error`)}))}},mounted(){this.getCarts()}},de=t(3744);const ce=(0,de.Z)(ne,[["render",ie]]);var me=ce},5689:function(e,s,t){e.exports=t.p+"img/people03.128798c0.svg"}}]);
//# sourceMappingURL=26.eef9ff22.js.map