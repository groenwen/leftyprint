"use strict";(self["webpackChunkleftyprint"]=self["webpackChunkleftyprint"]||[]).push([[763],{2763:function(e,o,n){n.r(o),n.d(o,{default:function(){return q}});var t=n(6252),l=n(3577);const a={key:1,class:"container"},s={class:"text-end"},i={class:"table"},d=(0,t._)("thead",null,[(0,t._)("th",null,"活動名稱"),(0,t._)("th",null,"折扣"),(0,t._)("th",null,"有效期限"),(0,t._)("th",null,"折扣碼"),(0,t._)("th",null,"顯示")],-1),c=["onClick"],u=["checked"],p={key:0,class:"form-check-label",for:"is_enabled"},r={key:1,class:"form-check-label",for:"is_enabled"},h={class:"text-end"},b=["onClick"],_=(0,t.Uk)("  "),m=["onClick"];function w(e,o,n,w,f,k){const y=(0,t.up)("v-loading"),C=(0,t.up)("couponModal");return(0,t.wg)(),(0,t.iD)(t.HY,null,[f.isLoading?((0,t.wg)(),(0,t.j4)(y,{key:0,active:f.isLoading},null,8,["active"])):((0,t.wg)(),(0,t.iD)("div",a,[(0,t._)("div",s,[(0,t._)("button",{type:"button",class:"btn btn-dark",onClick:o[0]||(o[0]=e=>k.openModal("new"))}," 新增 ")]),(0,t._)("table",i,[d,(0,t._)("tbody",null,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(f.coupons,(o=>((0,t.wg)(),(0,t.iD)("tr",{key:o.id},[(0,t._)("td",null,(0,l.zw)(o.title),1),(0,t._)("td",null,(0,l.zw)(o.percent),1),(0,t._)("td",null,(0,l.zw)(k.parseDate(o.due_date)),1),(0,t._)("td",null,(0,l.zw)(o.code),1),(0,t._)("td",null,[(0,t._)("div",{class:"form-check form-switch",onClick:n=>{o.is_enabled?o.is_enabled=0:o.is_enabled=1,e.updateProduct(o)}},[(0,t._)("input",{class:"form-check-input",type:"checkbox",role:"switch",id:"is_enabled",checked:1===o.is_enabled},null,8,u),1===o.is_enabled?((0,t.wg)(),(0,t.iD)("label",p,"顯示")):((0,t.wg)(),(0,t.iD)("label",r,"隱藏"))],8,c)]),(0,t._)("td",h,[(0,t._)("button",{type:"button",class:"btn btn-sm btn-outline-dark",onClick:e=>k.openModal("edit",o)}," 編輯",8,b),_,(0,t._)("button",{type:"button",class:"btn btn-sm btn-outline-danger",onClick:e=>k.openModal("delete",o)}," 刪除 ",8,m)])])))),128))])])])),(0,t.Wm)(C,{"is-new":f.isNew,"coupon-item":f.coupon,onUpdateCoupon:k.updateCoupon,ref:"callModal"},null,8,["is-new","coupon-item","onUpdateCoupon"])],64)}var f=n(9963);const k={class:"modal fade",ref:"couponModal","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},y={class:"modal-dialog modal-xl"},C={class:"modal-content"},g={class:"modal-header"},M={key:0,class:"modal-title"},v={key:1,class:"modal-title"},D=(0,t._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),N={class:"modal-body"},$={class:"mb-3"},U=(0,t._)("label",{for:"title",class:"form-label"},"活動名稱",-1),x={class:"mb-3"},I=(0,t._)("label",{for:"percent",class:"form-label"},"折扣",-1),P={class:"mb-3"},V=(0,t._)("label",{for:"due_date",class:"form-label"},"有效期限",-1),z={class:"mb-3"},O=(0,t._)("label",{for:"code",class:"form-label"},"折扣碼",-1),J=["checked"],L={key:0,class:"form-check-label",for:"is_enabled"},S={key:1,class:"form-check-label",for:"is_enabled"},A={class:"modal-footer"},E=(0,t._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1);function Y(e,o,n,a,s,i){return(0,t.wg)(),(0,t.iD)("div",k,[(0,t._)("div",y,[(0,t._)("div",C,[(0,t._)("div",g,[s.innIsNew?((0,t.wg)(),(0,t.iD)("h5",M,"新增折扣碼")):((0,t.wg)(),(0,t.iD)("h5",v,(0,l.zw)(s.innCoupon.title),1)),D]),(0,t._)("div",N,[(0,t._)("div",$,[U,(0,t.wy)((0,t._)("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":o[0]||(o[0]=e=>s.innCoupon.title=e),placeholder:"輸入活動"},null,512),[[f.nr,s.innCoupon.title]])]),(0,t._)("div",x,[I,(0,t.wy)((0,t._)("input",{type:"number",class:"form-control",id:"percent","onUpdate:modelValue":o[1]||(o[1]=e=>s.innCoupon.percent=e),placeholder:"輸入折扣"},null,512),[[f.nr,s.innCoupon.percent]])]),(0,t._)("div",P,[V,(0,t.wy)((0,t._)("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":o[2]||(o[2]=e=>s.innCoupon.due_date=e),placeholder:"輸入有效期限"},null,512),[[f.nr,s.innCoupon.due_date]])]),(0,t._)("div",z,[O,(0,t.wy)((0,t._)("input",{type:"text",class:"form-control",id:"code","onUpdate:modelValue":o[3]||(o[3]=e=>s.innCoupon.code=e),placeholder:"輸入折扣碼"},null,512),[[f.nr,s.innCoupon.code]])]),(0,t._)("div",null,[(0,t._)("div",{class:"form-check form-switch",onClick:o[4]||(o[4]=e=>s.innCoupon.is_enabled?s.innCoupon.is_enabled=0:s.innCoupon.is_enabled=1)},[(0,t._)("input",{class:"form-check-input",type:"checkbox",role:"switch",id:"is_enabled",checked:1===s.innCoupon.is_enabled},null,8,J),1===s.innCoupon.is_enabled?((0,t.wg)(),(0,t.iD)("label",L,"顯示")):((0,t.wg)(),(0,t.iD)("label",S,"隱藏"))])])]),(0,t._)("div",A,[E,(0,t._)("button",{type:"button",class:"btn btn-primary",onClick:o[5]||(o[5]=e=>i.updateCoupon(s.innCoupon))},"儲存")])])])],512)}var j=n(7424),B=n.n(j),H={data(){return{myModal:"",innIsNew:!1,innCoupon:{is_enabled:1}}},props:{isNew:{type:Boolean},couponItem:{type:Object}},watch:{isNew(){this.innIsNew=this.isNew},couponItem(){this.innCoupon=JSON.parse(JSON.stringify(this.couponItem))}},methods:{showModal(){this.myModal.show(),console.log(this.innCoupon)},hideModal(){this.myModal.hide()},updateCoupon(e){this.$emit("updateCoupon",e)}},mounted(){this.myModal=new(B())(this.$refs.couponModal),this.innIsNew=this.isNew,this.innCoupon=JSON.parse(JSON.stringify(this.couponItem))}},Z=n(3744);const F=(0,Z.Z)(H,[["render",Y]]);var K=F,T={data(){return{VUE_APP:"https://vue3-course-api.hexschool.io/v2/api/groen",isLoading:!1,isNew:!1,coupons:[],coupon:{title:"",is_enabled:1,percent:80,due_date:1555459200,code:"leftyprint2022"}}},components:{couponModal:K},methods:{getCoupons(){this.$http.get(`${this.VUE_APP}/admin/coupons`).then((e=>{this.coupons=e.data.coupons})).catch((e=>{alert(e.response.data.message)}))},updateCoupon(e){e.due_date=new Date(e.due_date).getTime();const o={...e};let n=`${this.VUE_APP}/admin/coupon`,t="post";this.isNew||(t="put",n=`${n}/${e.id}`),this.$http[t](n,{data:o}).then((e=>{this.hideModal(),this.getCoupons()})).catch((e=>{console.log(e)}))},parseDate(e){const o=new Date(e).getFullYear(),n=new Date(e).getMonth()+1,t=new Date(e).getDate();return`${o}-${n}-${t}`},openModal(e,o){"new"===e?(this.coupon={is_enabled:1},this.$refs.callModal.showModal(),this.isNew=!0):"edit"===e?(o.due_date=this.parseDate(o.due_date),this.coupon={...o},this.$refs.callModal.showModal(),this.isNew=!1):"delete"===e&&(this.coupon={...o},this.$refs.callDelModal.showModal())},hideModal(){this.$refs.callModal.hideModal()}},mounted(){this.getCoupons()}};const W=(0,Z.Z)(T,[["render",w]]);var q=W}}]);
//# sourceMappingURL=763.3d5c2c42.js.map